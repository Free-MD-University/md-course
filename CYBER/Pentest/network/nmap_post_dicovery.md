the port discovery allow to discover which app run on a port and each version .

nmap can have multiple level of discovery from more aggressive to less aggressive way. 

we need to use the -sV {version} to make a discovery scan port 

- version can be :
- --version-light


# SC 

# OS detection

with -O we can use os detection 

# nmap script 

nmap allow to create script 

a lot of script already in /usr/share/nmap/scripts 

## smb dicovery 

we can use a script to find permission for a smb dir in an host :
nmap -p445 --script smb-enum-shares {IP}

# SMB connection 
when found a smb connection we can connect with the smbclient 

smbclient //{IP}/{SharedFile} -N


# LDAP Anonymous

Ldap is a way to authenticate an user. 
we can enumerate anonymous allowed  service 
## LDAPSEARCH 

ldapsearch -x -H ldap://{IP} -s base
-x : anonymous 
-H ldap//{IP}: host
-s base: only base object not a founded service 

after gived defaultNamingContext we can use :

ldapsearch -x -H ldap://10.211.11.10 -b "{defaultNamingContext}" "(objectClass=person)"

to find all personne or other LDAP object .

# Enum4linux-ng

enum4linux-ng -A 10.211.11.10 -oA results.txt

# RPC Micorsoft 


the RPC allow to use SMB to use a system from another computer .
If there is a misconfigured configuration of the IPC$ share  we can get a lot of technique 
rpcclient -U "" 10.211.11.10 -N

-U "":anonymous user
-M : No password 

If we get access there is a list of RPC command to use:

enumdomusers, getdompwinfo, help ..


# kerbrute
kerbrute allow to confirm username that we get with RPC or Enum4Linux 

that will try to connect to kerberos server and  check the validuty of the user 

./kerbrute userenum --dc {dc ip} -d {domain} {username found}

# CrackMapExec

is this a tool allow a lot of thing but we will use it to password spraying 

after that we get the password policy from the getdompwinfo of the RPC we can check with 

crackmapexec smb {smb} -u {list of user} -p {mini list of password}

